system = "windows"

[output]
name = "enhanced_shimcache_data"
directory = "./tmp"
format = "json"
compress = false
endpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"
collection_id = 1
output = "local"

[[artifacts]]
artifact_name = "script"
[artifacts.script]
name = "shimache_and_metadata"
script = "Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9zaGltY2FjaGUudHMKZnVuY3Rpb24gZ2V0U2hpbWNhY2hlKCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9zaGltY2FjaGUoKTsKICBjb25zdCByZXN1bHRzID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcmVzdWx0czsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvZmlsZXN5c3RlbS9maWxlcy50cwpmdW5jdGlvbiBzdGF0KHBhdGgpIHsKICBjb25zdCBkYXRhID0gZnMuc3RhdChwYXRoKTsKICBjb25zdCB2YWx1ZSA9IEpTT04ucGFyc2UoZGF0YSk7CiAgcmV0dXJuIHZhbHVlOwp9CmZ1bmN0aW9uIGhhc2gocGF0aCwgbWQ1LCBzaGExLCBzaGEyNTYpIHsKICBjb25zdCBkYXRhID0gZnMuaGFzaChwYXRoLCBtZDUsIHNoYTEsIHNoYTI1Nik7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIG1haW4udHMKZnVuY3Rpb24gY3JlYXRlX2VudHJ5KGVudHJ5KSB7CiAgY29uc3Qgc2hpbSA9IHsKICAgIG1kNTogIiIsCiAgICBjcmVhdGVkOiAwLAogICAgbW9kaWZpZWQ6IDAsCiAgICBhY2Nlc3NlZDogMCwKICAgIHNpemU6IDAsCiAgICBlbnRyeTogZW50cnkuZW50cnksCiAgICBwYXRoOiBlbnRyeS5wYXRoLAogICAgbGFzdF9tb2RpZmllZDogZW50cnkubGFzdF9tb2RpZmllZCwKICAgIGtleV9wYXRoOiBlbnRyeS5rZXlfcGF0aAogIH07CiAgcmV0dXJuIHNoaW07Cn0KZnVuY3Rpb24gbWFpbigpIHsKICBjb25zdCBzaGltY2FjaGVfZW50cmllcyA9IGdldFNoaW1jYWNoZSgpOwogIGNvbnN0IHNoaW1fYXJyYXkgPSBbXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHNoaW1jYWNoZV9lbnRyaWVzKSB7CiAgICB0cnkgewogICAgICBjb25zdCBpbmZvID0gc3RhdChlbnRyeS5wYXRoKTsKICAgICAgaWYgKGluZm8ubW9kaWZpZWQgPT09IG51bGwgfHwgaW5mby5jcmVhdGVkID09PSBudWxsKSB7CiAgICAgICAgY29uc3Qgc2hpbTIgPSBjcmVhdGVfZW50cnkoZW50cnkpOwogICAgICAgIHNoaW1fYXJyYXkucHVzaChzaGltMik7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgY29uc3Qgc2hpbSA9IHsKICAgICAgICBtZDU6IGhhc2goZW50cnkucGF0aCwgdHJ1ZSwgZmFsc2UsIGZhbHNlKS5tZDUsCiAgICAgICAgY3JlYXRlZDogaW5mby5jcmVhdGVkLAogICAgICAgIG1vZGlmaWVkOiBpbmZvLm1vZGlmaWVkLAogICAgICAgIGFjY2Vzc2VkOiBpbmZvLmFjY2Vzc2VkLAogICAgICAgIHNpemU6IGluZm8uc2l6ZSwKICAgICAgICBlbnRyeTogZW50cnkuZW50cnksCiAgICAgICAgcGF0aDogZW50cnkucGF0aCwKICAgICAgICBsYXN0X21vZGlmaWVkOiBlbnRyeS5sYXN0X21vZGlmaWVkLAogICAgICAgIGtleV9wYXRoOiBlbnRyeS5rZXlfcGF0aAogICAgICB9OwogICAgICBzaGltX2FycmF5LnB1c2goc2hpbSk7CiAgICB9IGNhdGNoIChfZXJyb3IpIHsKICAgICAgY29uc3Qgc2hpbSA9IGNyZWF0ZV9lbnRyeShlbnRyeSk7CiAgICAgIHNoaW1fYXJyYXkucHVzaChzaGltKTsKICAgICAgY29udGludWU7CiAgICB9CiAgfQogIHJldHVybiBzaGltX2FycmF5Owp9Cm1haW4oKTsK"