system = "windows"

[output]
name = "dfir_museum"
directory = "./tmp"
format = "json"
compress = false
endpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"
collection_id = 1
output = "local"

[[artifacts]]
artifact_name = "script"
[artifacts.script]
name = "dfir_museum_test"
# This collection parses supported DFIR Musuem artifacts at C:\DFIRArtifactMuseum from multiple different Windows versions
script = "Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9ldmVudGxvZ3MudHMKZnVuY3Rpb24gZ2V0RXZlbnRsb2dzKHBhdGgpIHsKICBjb25zdCByZXN1bHRzID0ganNfZ2V0X2V2ZW50bG9ncyhwYXRoKTsKICByZXR1cm4gcmVzdWx0czsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9wcmVmZXRjaC50cwpmdW5jdGlvbiBnZXRQcmVmZXRjaFBhdGgocGF0aCkgewogIGNvbnN0IGRhdGEgPSBqc19nZXRfcHJlZmV0Y2hfcGF0aChwYXRoKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9yZWdpc3RyeS50cwpmdW5jdGlvbiBnZXRSZWdpc3RyeShwYXRoKSB7CiAgY29uc3QgZGF0YSA9IGpzX2dldF9yZWdpc3RyeShwYXRoKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9zaG9ydGN1dHMudHMKZnVuY3Rpb24gZ2V0TG5rRmlsZShwYXRoKSB7CiAgY29uc3QgZGF0YSA9IGpzX2dldF9sbmtfZmlsZShwYXRoKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9zcnVtLnRzCmZ1bmN0aW9uIGdldFNydW1BcHBsaWNhdGlvbkluZm8ocGF0aCkgewogIGNvbnN0IG5hbWUgPSAie0QxMENBMkZFLTZGQ0YtNEY2RC04NDhFLUIyRTk5MjY2RkE4OX0iOwogIGNvbnN0IGRhdGEgPSBqc19nZXRfc3J1bShwYXRoLCBuYW1lKTsKICByZXR1cm4gZGF0YTsKfQpmdW5jdGlvbiBnZXRTcnVtQXBwbGljYXRpb25UaW1lbGluZShwYXRoKSB7CiAgY29uc3QgbmFtZSA9ICJ7NUM4Q0YxQzctNzI1Ny00RjEzLUIyMjMtOTcwRUY1OTM5MzEyfSI7CiAgY29uc3QgZGF0YSA9IGpzX2dldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CmZ1bmN0aW9uIGdldFNydW1BcHBsaWNhdGlvblZmdShwYXRoKSB7CiAgY29uc3QgbmFtZSA9ICJ7N0FDQkJBQTMtRDAyOS00QkU0LTlBN0EtMDg4NTkyN0YxRDhGfSI7CiAgY29uc3QgZGF0YSA9IGpzX2dldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CmZ1bmN0aW9uIGdldFNydW1FbmVyZ3lJbmZvKHBhdGgpIHsKICBjb25zdCBuYW1lID0gIntEQTczRkI4OS0yQkVBLTREREMtODZCOC02RTA0OEM2REE0Nzd9IjsKICBjb25zdCBkYXRhID0ganNfZ2V0X3NydW0ocGF0aCwgbmFtZSk7CiAgY29uc3QgcmVzdWx0cyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgcmV0dXJuIHJlc3VsdHM7Cn0KZnVuY3Rpb24gZ2V0U3J1bUVuZXJneVVzYWdlKHBhdGgpIHsKICBsZXQgbmFtZSA9ICJ7RkVFNEUxNEYtMDJBOS00NTUwLUI1Q0UtNUZBMkRBMjAyRTM3fSI7CiAgY29uc3QgZGF0YSA9IGpzX2dldF9zcnVtKHBhdGgsIG5hbWUpOwogIG5hbWUgPSAie0ZFRTRFMTRGLTAyQTktNDU1MC1CNUNFLTVGQTJEQTIwMkUzN31MVCI7CiAgY29uc3QgZGF0YV9sdCA9IGpzX2dldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIGNvbnN0IHNydW1fYWxsID0gcmVzdWx0cy5jb25jYXQoSlNPTi5wYXJzZShkYXRhX2x0KSk7CiAgcmV0dXJuIHNydW1fYWxsOwp9CmZ1bmN0aW9uIGdldFNydW1OZXR3b3JrSW5mbyhwYXRoKSB7CiAgY29uc3QgbmFtZSA9ICJ7OTczRjVENUMtMUQ5MC00OTQ0LUJFOEUtMjRCOTQyMzFBMTc0fSI7CiAgY29uc3QgZGF0YSA9IGpzX2dldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CmZ1bmN0aW9uIGdldFNydW1OZXR3b3JrQ29ubmVjdGl2aXR5KHBhdGgpIHsKICBjb25zdCBuYW1lID0gIntERDY2MzZDNC04OTI5LTQ2ODMtOTc0RS0yMkMwNDZBNDM3NjN9IjsKICBjb25zdCBkYXRhID0ganNfZ2V0X3NydW0ocGF0aCwgbmFtZSk7CiAgY29uc3QgcmVzdWx0cyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgcmV0dXJuIHJlc3VsdHM7Cn0KZnVuY3Rpb24gZ2V0U3J1bU5vdGlmaWNhdGlvbnMocGF0aCkgewogIGNvbnN0IG5hbWUgPSAie0QxMENBMkZFLTZGQ0YtNEY2RC04NDhFLUIyRTk5MjY2RkE4Nn0iOwogIGNvbnN0IGRhdGEgPSBqc19nZXRfc3J1bShwYXRoLCBuYW1lKTsKICBjb25zdCByZXN1bHRzID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcmVzdWx0czsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvZmlsZXN5c3RlbS9kaXJlY3RvcnkudHMKYXN5bmMgZnVuY3Rpb24gcmVhZERpcihwYXRoKSB7CiAgY29uc3QgZGF0YSA9IGF3YWl0IGpzX3JlYWRfZGlyKHBhdGgpOwogIHJldHVybiBkYXRhOwp9CgovLyBtYWluLnRzCnZhciBzdGFydF9wYXRoID0gIkM6XFxERklSQXJ0aWZhY3RNdXNldW0iOwphc3luYyBmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IGFtY2FjaGVzID0gYnVsa0FtY2FjaGVUZXN0cygpOwogIGNvbnN0IHNob3J0Y3V0cyA9IGF3YWl0IGJ1bGtTaG9ydGN1dHMoKTsKICBjb25zdCBwcmVmZXRjaHMgPSBidWxrUHJlZmV0Y2goKTsKICBjb25zdCBsb2dzID0gYXdhaXQgYnVsa0V2ZW50bG9ncygpOwogIGNvbnN0IHNydW1zID0gYnVsa1NSVU0oKTsKICBjb25zdCByZWdpc3RyeXMgPSBhd2FpdCBidWxrUmVnaXN0cnkoKTsKICBjb25zdCByZXN1bHRzID0gewogICAgYW1jYWNoZXMsCiAgICBzaG9ydGN1dHMsCiAgICBwcmVmZXRjaHMsCiAgICBsb2dzLAogICAgc3J1bXMsCiAgICByZWdpc3RyeXMKICB9OwogIHJldHVybiByZXN1bHRzOwp9CmZ1bmN0aW9uIGJ1bGtBbWNhY2hlVGVzdHMoKSB7CiAgY29uc3QgYW1jYWNoZXMgPSBbXTsKICBjb25zdCBwYXRocyA9IFsKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxBbWNhY2hlXFxXaW4xMFxcQVBUU2ltdWxhdG9yVk1cXEFtY2FjaGUuaHZlYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxBbWNhY2hlXFxXaW4xMFxcUmF0aGJ1blZNXFxBbWNhY2hlLmh2ZWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcQW1jYWNoZVxcV2luMTFcXFJhdGhidW5WTVxcQW1jYWNoZS5odmVgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXEFtY2FjaGVcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXEFtY2FjaGUuaHZlYAogIF07CiAgZm9yIChjb25zdCBlbnRyeSBvZiBwYXRocykgewogICAgY29uc29sZS5sb2coYFBhcnNpbmcgQW1jYWNoZSAke2VudHJ5fWApOwogICAgY29uc3QgcmVzdWx0ID0gZ2V0UmVnaXN0cnkoZW50cnkpOwogICAgYW1jYWNoZXMucHVzaChyZXN1bHQpOwogIH0KICByZXR1cm4gYW1jYWNoZXM7Cn0KYXN5bmMgZnVuY3Rpb24gYnVsa1Nob3J0Y3V0cygpIHsKICBjb25zdCBzaG9ydGN1dHMgPSBbXTsKICBjb25zdCBwYXRocyA9IFsKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxMTktcXFdpbjdgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXExOS1xcV2luOC4wYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxMTktcXFdpbjguMWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcTE5LXFxXaW4xMGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcTE5LXFxXaW4xMVxcUmF0aGJ1blZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxMTktcXFdpbjIwMTJgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXExOS1xcV2luMjAxMlIyXFxTdG9sZW5TemVjaHVhbmAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcTE5LXFxXaW4yMDEyUjJcXEVyaWNaaW1tZXJtYW5gCiAgXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHBhdGhzKSB7CiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgYXdhaXQgcmVhZERpcihlbnRyeSkpIHsKICAgICAgY29uc3QgbG5rX2ZpbGUgPSBgJHtlbnRyeX1cXCR7ZmlsZS5maWxlbmFtZX1gOwogICAgICBjb25zb2xlLmxvZyhgUGFyc2luZyBTaG9ydGN1dCAke2xua19maWxlfWApOwogICAgICBjb25zdCByZXN1bHQgPSBnZXRMbmtGaWxlKGxua19maWxlKTsKICAgICAgc2hvcnRjdXRzLnB1c2gocmVzdWx0KTsKICAgIH0KICB9CiAgcmV0dXJuIHNob3J0Y3V0czsKfQpmdW5jdGlvbiBidWxrUHJlZmV0Y2goKSB7CiAgY29uc3QgcHJlZmV0Y2hzID0gW107CiAgY29uc3QgcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjdcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjhcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjdTUDFcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjEwXFxBUFRTaW11bGF0b3JWTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjEwXFxSYXRoYnVuVk1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFByZWZldGNoXFxXaW4xMVxcUmF0aGJ1blZNXFxDb21wcmVzc2VkYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxQcmVmZXRjaFxcV2luODFOb1VwZGF0ZVxcUmF0aGJ1blZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxQcmVmZXRjaFxcV2luODFVcGRhdGVcXFJhdGhidW5WTWAKICBdOwogIGZvciAoY29uc3QgZW50cnkgb2YgcGF0aHMpIHsKICAgIGNvbnNvbGUubG9nKGBQYXJzaW5nIFByZWZldGNoIGRpcmVjdG9yeSAke2VudHJ5fWApOwogICAgY29uc3QgcmVzdWx0ID0gZ2V0UHJlZmV0Y2hQYXRoKGVudHJ5KTsKICAgIHByZWZldGNocy5wdXNoKHJlc3VsdCk7CiAgfQogIHJldHVybiBwcmVmZXRjaHM7Cn0KYXN5bmMgZnVuY3Rpb24gYnVsa0V2ZW50bG9ncygpIHsKICBjb25zdCBsb2dzID0gW107CiAgY29uc3QgcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcRXZlbnRMb2dzXFxXaW4xMFxcUmF0aGJ1blZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxFdmVudExvZ3NcXFdpbjEwXFxBUFRTaW11bGF0b3JWTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcRXZlbnRMb2dzXFxXaW4xMFxcQmVsa2Fzb2Z0Q1RGX0luc2lkZXJUaHJlYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXEV2ZW50TG9nc1xcV2luMTBcXEFQVFNpbXVsYXRvclZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxFdmVudExvZ3NcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcRXZlbnRMb2dzXFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxFdmVudExvZ3NcXFdpbjExXFxSYXRoYnVuVk1gCiAgXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHBhdGhzKSB7CiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgYXdhaXQgcmVhZERpcihlbnRyeSkpIHsKICAgICAgaWYgKCFmaWxlLmZpbGVuYW1lLmluY2x1ZGVzKCJldnR4IikpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBsb2dfZmlsZSA9IGAke2VudHJ5fVxcJHtmaWxlLmZpbGVuYW1lfWA7CiAgICAgIGNvbnNvbGUubG9nKGBQYXJzaW5nIEV2ZW50TG9ncyBkaXJlY3RvcnkgJHtsb2dfZmlsZX1gKTsKICAgICAgY29uc3QgcmVzdWx0ID0gZ2V0RXZlbnRsb2dzKGxvZ19maWxlKTsKICAgICAgbG9ncy5wdXNoKHJlc3VsdCk7CiAgICB9CiAgfQogIHJldHVybiBsb2dzOwp9CmZ1bmN0aW9uIGJ1bGtTUlVNKCkgewogIGNvbnN0IHNydW1zID0gewogICAgYXBwaW5mbzogW10sCiAgICB0aW1lbGluZTogW10sCiAgICBuZXRpbmZvOiBbXSwKICAgIGNvbm5lY3Q6IFtdLAogICAgbm90aWZzOiBbXSwKICAgIGVuZXJneTogW10sCiAgICBlbmVyZ3lpbmZvOiBbXSwKICAgIHZmdTogW10KICB9OwogIGNvbnN0IHBhdGhzID0gWwogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFNSVU1cXFdpbjEwXFxSYXRoYnVuVk1cXENsZWFuXFxTUlVEQi5kYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFNSVU1cXFdpbjEwXFxSYXRoYnVuVk1cXERpcnR5XFxTUlVEQi5kYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFNSVU1cXFdpbjEwXFxBUFRTaW11bGF0b3JWTVxcQ2xlYW5cXFNSVURCLmRhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcU1JVTVxcV2luMTBcXEJlbGthc29mdENURl9JbnNpZGVyVGhyZWF0XFxDbGVhblxcU1JVREIuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxTUlVNXFxXaW4xMFxcQmVsa2Fzb2Z0Q1RGX0luc2lkZXJUaHJlYXRcXERpcnR5XFxTUlVEQi5kYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFNSVU1cXFdpbjExXFxSYXRoYnVuVk1cXENsZWFuXFxTUlVEQi5kYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFNSVU1cXFdpbjExXFxSYXRoYnVuVk1cXERpcnR5XFxTUlVEQi5kYXRgCiAgXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHBhdGhzKSB7CiAgICBjb25zb2xlLmxvZyhgUGFyc2luZyBTUlVNICR7ZW50cnl9YCk7CiAgICBzcnVtcy5hcHBpbmZvLnB1c2goZ2V0U3J1bUFwcGxpY2F0aW9uSW5mbyhlbnRyeSkpOwogICAgc3J1bXMuY29ubmVjdC5wdXNoKGdldFNydW1OZXR3b3JrQ29ubmVjdGl2aXR5KGVudHJ5KSk7CiAgICBzcnVtcy5lbmVyZ3kucHVzaChnZXRTcnVtRW5lcmd5VXNhZ2UoZW50cnkpKTsKICAgIHNydW1zLmVuZXJneWluZm8ucHVzaChnZXRTcnVtRW5lcmd5SW5mbyhlbnRyeSkpOwogICAgc3J1bXMubm90aWZzLnB1c2goZ2V0U3J1bU5vdGlmaWNhdGlvbnMoZW50cnkpKTsKICAgIHNydW1zLm5ldGluZm8ucHVzaChnZXRTcnVtTmV0d29ya0luZm8oZW50cnkpKTsKICAgIHNydW1zLnZmdS5wdXNoKGdldFNydW1BcHBsaWNhdGlvblZmdShlbnRyeSkpOwogICAgc3J1bXMudGltZWxpbmUucHVzaChnZXRTcnVtQXBwbGljYXRpb25UaW1lbGluZShlbnRyeSkpOwogIH0KICByZXR1cm4gc3J1bXM7Cn0KYXN5bmMgZnVuY3Rpb24gYnVsa1JlZ2lzdHJ5KCkgewogIGNvbnN0IHJlZ3MgPSBbXTsKICBjb25zdCBwYXRocyA9IFsKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxTQU1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcQVBUU2ltdWxhdG9yVk1cXFNPRlRXQVJFYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxTWVNURU1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcQVBUU2ltdWxhdG9yVk1cXFNFQ1VSSVRZYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxERUZBVUxUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxUZXN0VXNlclxcTlRVU0VSLkRBVGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxBUFRTaW11bGF0b3JWTVxcVGVzdFVzZXJcXFVzckNsYXNzLmRhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcU0FNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEJlbGthc29mdENURl9JbnNpZGVyVGhyZWF0XFxTT0ZUV0FSRWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcU1lTVEVNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEJlbGthc29mdENURl9JbnNpZGVyVGhyZWF0XFxTRUNVUklUWWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcREVGQVVMVGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXFNBTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXFNPRlRXQVJFYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcU1lTVEVNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcU0VDVVJJVFlgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxERUZBVUxUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcQ09NUE9ORU5UU2AsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXEJCSWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXEVMQU1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxCQ0QtVGVtcGxhdGVgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxOVFVTRVIuREFUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcVXNyQ2xhc3MuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcRFJJVkVSU2AsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXERFRkFVTFQgKE5UVVNFUilcXE5UVVNFUi5EQVRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxMb2NhbFNlcnZpY2VcXE5UVVNFUi5EQVRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxOZXR3b3JrU2VydmljZVxcTlRVU0VSLkRBVGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXFNBTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXFNZU1RFTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXFNPRlRXQVJFYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMjAxMlIyXFxTdG9sZW5TemVjaHVhblxcU0VDVVJJVFlgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuXFxCQklgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuXFxERUZBVUxUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMjAxMlIyXFxTdG9sZW5TemVjaHVhblxcRFJJVkVSU2AKICBdOwogIGZvciAoY29uc3QgZW50cnkgb2YgcGF0aHMpIHsKICAgIGNvbnNvbGUubG9nKGBQYXJzaW5nIFJlZ2lzdHJ5IGZpbGUgJHtlbnRyeX1gKTsKICAgIGNvbnN0IHJlc3VsdCA9IGdldFJlZ2lzdHJ5KGVudHJ5KTsKICAgIHJlZ3MucHVzaChyZXN1bHQpOwogIH0KICBjb25zdCB6aW1fcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjdcXEVyaWNaaW1tZXJtYW5gCiAgXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHppbV9wYXRocykgewogICAgZm9yIChjb25zdCBmaWxlIG9mIGF3YWl0IHJlYWREaXIoZW50cnkpKSB7CiAgICAgIGNvbnN0IHJlZ19maWxlID0gYCR7ZW50cnl9XFwke2ZpbGUuZmlsZW5hbWV9YDsKICAgICAgY29uc29sZS5sb2coYFBhcnNpbmcgWmltbWVybWFuIFJlZyBmaWxlICR7cmVnX2ZpbGV9YCk7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzdWx0ID0gZ2V0UmVnaXN0cnkocmVnX2ZpbGUpOwogICAgICAgIHJlZ3MucHVzaChyZXN1bHQpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHBhcnNlICR7cmVnX2ZpbGV9IGVycm9yOiAke2V9YCk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHJlZ3M7Cn0KbWFpbigpOwoKCg=="
