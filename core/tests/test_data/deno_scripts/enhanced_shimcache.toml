system = "windows"

[output]
name = "enhanced_shimcache_data"
directory = "./tmp"
format = "json"
compress = false
timeline = false
endpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"
collection_id = 1
output = "local"

[[artifacts]]
artifact_name = "script"
[artifacts.script]
name = "shimache_and_metadata"
script = "Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9zaGltY2FjaGUudHMKZnVuY3Rpb24gZ2V0U2hpbWNhY2hlKCkgewogIGNvbnN0IGRhdGEgPSBqc19nZXRfc2hpbWNhY2hlKCk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9wdWZmeWNpZC9hcnRlbWlzLWFwaS9tYXN0ZXIvc3JjL2ZpbGVzeXN0ZW0vZmlsZXMudHMKZnVuY3Rpb24gc3RhdChwYXRoKSB7CiAgY29uc3QgZGF0YSA9IGpzX3N0YXQocGF0aCk7CiAgcmV0dXJuIGRhdGE7Cn0KZnVuY3Rpb24gaGFzaChwYXRoLCBtZDUsIHNoYTEsIHNoYTI1NikgewogIGNvbnN0IGRhdGEgPSBqc19oYXNoKHBhdGgsIG1kNSwgc2hhMSwgc2hhMjU2KTsKICByZXR1cm4gZGF0YTsKfQoKLy8gbWFpbi50cwpmdW5jdGlvbiBjcmVhdGVfZW50cnkoZW50cnkpIHsKICBjb25zdCBzaGltID0gewogICAgbWQ1OiAiIiwKICAgIGNyZWF0ZWQ6IDAsCiAgICBtb2RpZmllZDogMCwKICAgIGFjY2Vzc2VkOiAwLAogICAgc2l6ZTogMCwKICAgIGVudHJ5OiBlbnRyeS5lbnRyeSwKICAgIHBhdGg6IGVudHJ5LnBhdGgsCiAgICBsYXN0X21vZGlmaWVkOiBlbnRyeS5sYXN0X21vZGlmaWVkLAogICAga2V5X3BhdGg6IGVudHJ5LmtleV9wYXRoCiAgfTsKICByZXR1cm4gc2hpbTsKfQpmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IHNoaW1jYWNoZV9lbnRyaWVzID0gZ2V0U2hpbWNhY2hlKCk7CiAgY29uc3Qgc2hpbV9hcnJheSA9IFtdOwogIGZvciAoY29uc3QgZW50cnkgb2Ygc2hpbWNhY2hlX2VudHJpZXMpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGluZm8gPSBzdGF0KGVudHJ5LnBhdGgpOwogICAgICBpZiAoaW5mby5tb2RpZmllZCA9PT0gbnVsbCB8fCBpbmZvLmNyZWF0ZWQgPT09IG51bGwpIHsKICAgICAgICBjb25zdCBzaGltMiA9IGNyZWF0ZV9lbnRyeShlbnRyeSk7CiAgICAgICAgc2hpbV9hcnJheS5wdXNoKHNoaW0yKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBzaGltID0gewogICAgICAgIG1kNTogaGFzaChlbnRyeS5wYXRoLCB0cnVlLCBmYWxzZSwgZmFsc2UpLm1kNSwKICAgICAgICBjcmVhdGVkOiBpbmZvLmNyZWF0ZWQsCiAgICAgICAgbW9kaWZpZWQ6IGluZm8ubW9kaWZpZWQsCiAgICAgICAgYWNjZXNzZWQ6IGluZm8uYWNjZXNzZWQsCiAgICAgICAgc2l6ZTogaW5mby5zaXplLAogICAgICAgIGVudHJ5OiBlbnRyeS5lbnRyeSwKICAgICAgICBwYXRoOiBlbnRyeS5wYXRoLAogICAgICAgIGxhc3RfbW9kaWZpZWQ6IGVudHJ5Lmxhc3RfbW9kaWZpZWQsCiAgICAgICAga2V5X3BhdGg6IGVudHJ5LmtleV9wYXRoCiAgICAgIH07CiAgICAgIHNoaW1fYXJyYXkucHVzaChzaGltKTsKICAgIH0gY2F0Y2ggKF9lcnJvcikgewogICAgICBjb25zdCBzaGltID0gY3JlYXRlX2VudHJ5KGVudHJ5KTsKICAgICAgc2hpbV9hcnJheS5wdXNoKHNoaW0pOwogICAgICBjb250aW51ZTsKICAgIH0KICAgIGJyZWFrOwogIH0KICByZXR1cm4gc2hpbV9hcnJheTsKfQptYWluKCk7Cg=="
